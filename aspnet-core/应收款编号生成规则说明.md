# åº”æ”¶æ¬¾ç¼–å·ç”Ÿæˆè§„åˆ™è¯´æ˜

## ğŸ“‹ ç¼–å·æ ¼å¼

### æ ¼å¼è¯´æ˜
åº”æ”¶æ¬¾ç¼–å·é‡‡ç”¨ä»¥ä¸‹æ ¼å¼ï¼š`æ—¶é—´æˆ³-éšæœºå››ä½æ•°å­—`

### å…·ä½“æ ¼å¼
- **æ—¶é—´æˆ³éƒ¨åˆ†**: `yyyyMMddHHmmss` (14ä½æ•°å­—)
- **åˆ†éš”ç¬¦**: `-` (è¿å­—ç¬¦)
- **éšæœºæ•°éƒ¨åˆ†**: `1000-9999` (4ä½æ•°å­—ï¼Œä¸è¶³4ä½å‰é¢è¡¥0)

### ç¤ºä¾‹
```
20241201143025-1234
20241201143026-5678
20241201143027-0001
```

## ğŸ”§ ç”Ÿæˆé€»è¾‘

### 1. æ—¶é—´æˆ³ç”Ÿæˆ
```csharp
var currentTime = DateTime.Now.ToString("yyyyMMddHHmmss");
```
- ä½¿ç”¨å½“å‰ç³»ç»Ÿæ—¶é—´
- æ ¼å¼ï¼šå¹´(4ä½) + æœˆ(2ä½) + æ—¥(2ä½) + æ—¶(2ä½) + åˆ†(2ä½) + ç§’(2ä½)
- ç¡®ä¿æ—¶é—´é¡ºåºæ€§å’Œå”¯ä¸€æ€§

### 2. éšæœºæ•°ç”Ÿæˆ
```csharp
var random = new Random(Guid.NewGuid().GetHashCode());
var randomNumber = random.Next(1000, 10000);
```
- ä½¿ç”¨Guidçš„å“ˆå¸Œå€¼ä½œä¸ºéšæœºç§å­ï¼Œç¡®ä¿æ›´å¥½çš„éšæœºæ€§
- ç”Ÿæˆ1000-9999ä¹‹é—´çš„éšæœºæ•°
- ä½¿ç”¨`{randomNumber:D4}`æ ¼å¼åŒ–ï¼Œç¡®ä¿å§‹ç»ˆæ˜¯4ä½æ•°å­—

### 3. ç¼–å·ç»„è£…
```csharp
receivables.ReceivableCode = $"{currentTime}-{randomNumber:D4}";
```

## ğŸ¯ ä¸šåŠ¡è§„åˆ™

### 1. è‡ªåŠ¨ç”Ÿæˆæ¡ä»¶
- å½“ç”¨æˆ·æ²¡æœ‰æä¾›åº”æ”¶æ¬¾ç¼–å·æ—¶ï¼Œç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆ
- å½“ç”¨æˆ·æä¾›äº†ç¼–å·æ—¶ï¼Œä½¿ç”¨ç”¨æˆ·æä¾›çš„ç¼–å·

### 2. å”¯ä¸€æ€§ä¿è¯
- æ—¶é—´æˆ³ç¡®ä¿æ—¶é—´é¡ºåºæ€§
- éšæœºæ•°å‡å°‘åŒä¸€æ—¶é—´æˆ³çš„å†²çªæ¦‚ç‡
- ç†è®ºä¸Šæ¯ç§’å¯ä»¥ç”Ÿæˆ9000ä¸ªä¸åŒçš„ç¼–å·

### 3. å¯è¯»æ€§
- ç¼–å·åŒ…å«æ—¶é—´ä¿¡æ¯ï¼Œä¾¿äºè¯†åˆ«åˆ›å»ºæ—¶é—´
- æ ¼å¼ç»Ÿä¸€ï¼Œä¾¿äºæ’åºå’ŒæŸ¥æ‰¾

## ğŸ“ ä»£ç å®ç°

### æ ¸å¿ƒç”Ÿæˆä»£ç 
```csharp
// å¦‚æœç”¨æˆ·æ²¡æœ‰æä¾›ç¼–å·ï¼Œåˆ™è‡ªåŠ¨ç”Ÿæˆ
if (string.IsNullOrEmpty(receivables.ReceivableCode))
{
    var random = new Random(Guid.NewGuid().GetHashCode());
    var randomNumber = random.Next(1000, 10000);
    var currentTime = DateTime.Now.ToString("yyyyMMddHHmmss");
    receivables.ReceivableCode = $"{currentTime}-{randomNumber:D4}";
}
```

### æµ‹è¯•æ–¹æ³•
```csharp
public ApiResult<string> TestReceivableCodeGeneration()
{
    try
    {
        var random = new Random(Guid.NewGuid().GetHashCode());
        var randomNumber = random.Next(1000, 10000);
        var currentTime = DateTime.Now.ToString("yyyyMMddHHmmss");
        var generatedCode = $"{currentTime}-{randomNumber:D4}";
        
        return ApiResult<string>.Success(ResultCode.Success, $"ç”Ÿæˆçš„åº”æ”¶æ¬¾ç¼–å·: {generatedCode}");
    }
    catch (Exception ex)
    {
        return ApiResult<string>.Error(ResultCode.Error, $"ç¼–å·ç”Ÿæˆå¤±è´¥: {ex.Message}");
    }
}
```

## ğŸ” ä½¿ç”¨ç¤ºä¾‹

### 1. è‡ªåŠ¨ç”Ÿæˆç¼–å·
```json
POST /api/receivables
{
    "customerId": "12345678-1234-1234-1234-123456789012",
    "contractId": "87654321-4321-4321-4321-210987654321",
    "userId": "11111111-1111-1111-1111-111111111111",
    "receivablePay": 10000.00,
    "receivableDate": "2024-12-01T14:30:25",
    "remark": "æµ‹è¯•åº”æ”¶æ¬¾"
}
```

**å“åº”ç»“æœ**:
```json
{
    "code": 200,
    "message": "æ“ä½œæˆåŠŸ",
    "data": {
        "receivableCode": "20241201143025-1234",
        "customerId": "12345678-1234-1234-1234-123456789012",
        "contractId": "87654321-4321-4321-4321-210987654321",
        "userId": "11111111-1111-1111-1111-111111111111",
        "receivablePay": 10000.00,
        "receivableDate": "2024-12-01T14:30:25",
        "remark": "æµ‹è¯•åº”æ”¶æ¬¾"
    }
}
```

### 2. æ‰‹åŠ¨æŒ‡å®šç¼–å·
```json
POST /api/receivables
{
    "receivableCode": "CUSTOM-001",
    "customerId": "12345678-1234-1234-1234-123456789012",
    "contractId": "87654321-4321-4321-4321-210987654321",
    "userId": "11111111-1111-1111-1111-111111111111",
    "receivablePay": 10000.00,
    "receivableDate": "2024-12-01T14:30:25",
    "remark": "æµ‹è¯•åº”æ”¶æ¬¾"
}
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ—¶é—´åŒæ­¥**: ç¡®ä¿æœåŠ¡å™¨æ—¶é—´å‡†ç¡®ï¼Œé¿å…ç¼–å·é‡å¤
2. **å¹¶å‘å¤„ç†**: åœ¨é«˜å¹¶å‘æƒ…å†µä¸‹ï¼Œå¯èƒ½å­˜åœ¨æå°çš„é‡å¤æ¦‚ç‡
3. **ç¼–å·é•¿åº¦**: ç¼–å·æ€»é•¿åº¦ä¸º19ä½å­—ç¬¦
4. **æ’åºè§„åˆ™**: æŒ‰å­—ç¬¦ä¸²æ’åºå³å¯è·å¾—æ—¶é—´é¡ºåº
5. **æ•°æ®åº“ç´¢å¼•**: å»ºè®®ä¸ºReceivableCodeå­—æ®µåˆ›å»ºç´¢å¼•ä»¥æé«˜æŸ¥è¯¢æ€§èƒ½

## ğŸš€ æ‰©å±•å»ºè®®

1. **å‰ç¼€æ”¯æŒ**: å¯ä»¥æ·»åŠ ä¸šåŠ¡å‰ç¼€ï¼Œå¦‚"AR-"è¡¨ç¤ºåº”æ”¶æ¬¾
2. **åºåˆ—å·**: å¯ä»¥æ·»åŠ å½“å¤©çš„åºåˆ—å·ï¼Œå¦‚"20241201-001-1234"
3. **æ ¡éªŒä½**: å¯ä»¥æ·»åŠ æ ¡éªŒä½ç¡®ä¿ç¼–å·çš„å®Œæ•´æ€§
4. **æ‰¹é‡ç”Ÿæˆ**: æ”¯æŒæ‰¹é‡ç”Ÿæˆç¼–å·çš„åŠŸèƒ½ 